System.register(["./mui-legacy-BDTphHaF.js","./reactVendor-legacy-CtYIj4Ma.js","../index-legacy.BPYbSXo1.js","./react-setup-legacy-Bwwh9_Jr.js","./lang-legacy-C2M9M2Og.js","./lodashEs-legacy-Da1qF4L1.js","./b3Logger-legacy-C5y5ZQF8.js","./B3LinkTipContent-legacy-xZsV5ITn.js","./b3TriggerCartNumber-legacy-BWWQUXa7.js","./CreateShoppingList-legacy-ChXbCw_T.js","./OrderShoppingList-legacy-BTH5txts.js","./router-legacy-CCJEjNy7.js","./muiIcon-legacy-BXgwC5sb.js","./SearchProduct-legacy-BlaAQZfI.js","./useBlockPendingAccountViewPrice-legacy-BzhXnI3Y.js","./form-legacy-CAo5v63e.js","./B3CustomForm-legacy-BVFdU8az.js","./b2bGetVariantImageByVariantInfo-legacy-BFgbB579.js","./B3FilterMore-legacy-CFk9nW9w.js","./useSort-legacy-CfCrn6Eb.js","./B3FilterSearch-legacy-DYz9XuR_.js","./eReact-legacy-BRtOBtIF.js","./intl-legacy-DG3cM9-L.js","./eCache-legacy-BoIqTPuc.js","./eStyled-legacy-D59194a7.js","./redux-legacy-Dls004SH.js","./toolkit-legacy-6OFItfV5.js","./dateFns-legacy-DV9BM4UY.js","./dropzone-legacy-B_7NAEdu.js","./useCustomCallbacks-legacy-BXYZnszm.js","./b3ShoppingList-legacy-DBoBTyhL.js"],(function(e,t){"use strict";var r,s,n,a,i,o,d,c,u,l,p,h,x,g,m,f,y,k,P,j,S,b,v,I,C,q,O,A,L,w,T,E,B,Q,D,V,$,F,_,R,z,M,U,N,W,G,H,K,J,Y,Z,X,ee,te,re,se,ne,ae,ie,oe,de,ce,ue,le,pe,he;return{setters:[e=>{r=e.a9,s=e.j,n=e.G,a=e.B,i=e.T,o=e.V,d=e.W,c=e.e,u=e.J,l=e.ab,p=e.ae,h=e.Z,x=e.s,g=e.g},e=>{m=e.r},null,e=>{f=e.B,y=e.G,k=e.u,P=e.aO,j=e.R,S=e.a,b=e.an,v=e.a3,I=e.a5,C=e.aP,q=e.aQ,O=e.aJ,A=e.U,L=e.aR,w=e.aS,T=e.aE,E=e.aT,B=e.aU,Q=e.aV,D=e.aW,V=e.aF,$=e.aG,F=e.p,_=e.a2,R=e.aX,z=e.aH,M=e.aI,U=e.aY,N=e.al,W=e.ac,G=e.aZ},e=>{H=e.u},e=>{K=e.i},e=>{J=e.b},e=>{Y=e.s},e=>{Z=e.b},e=>{X=e.default},e=>{ee=e.default},e=>{te=e.u},e=>{re=e.b},e=>{se=e.S,ne=e.d},e=>{ae=e.u},e=>{ie=e.u},e=>{oe=e.B},e=>{de=e.b},e=>{ce=e.d,ue=e.B,le=e.a},e=>{pe=e.u},e=>{he=e.B},null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",(function(){const e=k(F),t=k((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),[r]=S(),[i,o]=m.useState(!1),[d,c]=m.useState([]),{purchasabilityPermission:u}=k(j),l=!e||u;return s.jsxs(a,{sx:{width:"100%"},children:[s.jsx(a,{sx:{display:"flex",justifyContent:"center"},children:s.jsxs(n,{sx:{m:0,width:"100%"},container:!0,spacing:2,children:[s.jsx(n,{item:!0,xs:r?12:8,sx:{backgroundColor:"#ffffff",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px",pr:"16px"},children:s.jsx(qe,{setCheckedArr:c,setIsRequestLoading:o,isRequestLoading:i})}),s.jsx(n,{item:!0,xs:r?12:4,sx:{pt:r?"16px":"0px !important",pl:r?"0px !important":"16px"},children:l&&s.jsx(ke,{isB2BUser:e})})]})}),s.jsx(a,{sx:{position:"fixed",bottom:0,left:0,width:"100%",zIndex:"999"},children:s.jsx(fe,{checkedArr:d,isAgenting:t,setIsRequestLoading:o,isB2BUser:e})})]})}));const t=(e,t,r)=>{const s=e.find((e=>+e.variant_id===t||r===e.sku))||{};return!K(s)&&+s.bc_calculated_price.tax_inclusive},xe=e=>`{\n  orderedProducts (\n    q: "${e.q||""}"\n    first: ${e.first}\n    offset: ${e.offset}\n    beginDateAt: "${e.beginDateAt}"\n    endDateAt: "${e.endDateAt}"\n    orderBy: "${e?.orderBy||""}"\n  ){\n    totalCount,\n    pageInfo{\n      hasNextPage,\n      hasPreviousPage,\n    },\n    edges{\n      node {\n        id,\n        createdAt,\n        updatedAt,\n        productName,\n        productBrandName,\n        variantSku,\n        productId,\n        variantId,\n        optionList,\n        orderedTimes,\n        firstOrderedAt,\n        lastOrderedAt,\n        lastOrderedItems,\n        sku,\n        lastOrdered,\n        imageUrl,\n        baseSku,\n        basePrice,\n        discount,\n        tax,\n        enteredInclusive,\n        productUrl,\n        optionSelections,\n      }\n    }\n  }\n}`,ge=e=>f.graphqlB2B({query:xe(e)}),me=e=>f.graphqlB2B({query:xe(e)});function fe(e){const{checkedArr:u,isAgenting:l,setIsRequestLoading:p,isB2BUser:h}=e,{state:{productQuoteEnabled:x=!1,shoppingListEnabled:g=!1}}=m.useContext(y),f=H(),F=k((e=>e.company.companyInfo.id)),{currency_code:_}=k(P),{purchasabilityPermission:R}=k(j),z=!h||R,M=r("(min-width:1775px)"),[U]=S(),N=m.useRef(null),[W,G]=m.useState(!1),[K,se]=m.useState(0),[ne,ae]=m.useState(!1),[ie,oe]=m.useState(!1),[de,ce]=m.useState(!1),ue=k((e=>e.company.customer.customerGroupId)),le=te(),pe=U?{alignItems:"flex-start",flexDirection:"column"}:{alignItems:"center"},he=()=>{G(!1)},xe=e=>0===e?.length?[]:e.map((({product_option_id:e,value:t})=>({optionId:`attribute[${e}]`,optionValue:t}))),ge=e=>s.jsxs(a,{sx:{display:"flex",alignItems:"center"},children:[s.jsx(a,{sx:{mr:"15px"},children:f("purchasedProducts.footer.productsAddedToShoppingList")}),s.jsx(c,{onClick:()=>(e=>{le(`/shoppingList/${e}`)})(e),variant:"text",sx:{color:"#ffffff",padding:0},children:"view shopping list"})]}),me=e=>{ae(!1),oe(!1)},fe=()=>{oe(!1),ae(!0)},ye=()=>{he(),fe(),ae(!0)},ke=[{name:f("purchasedProducts.footer.addToCart"),key:"add-selected-to-cart",handleClick:async()=>{p(!0),he();try{const e=[];if(u.forEach((t=>{const{node:r}=t;e.includes(+r.productId)||e.push(+r.productId)})),0===e.length)return void I.error(f("purchasedProducts.footer.selectOneItemToAdd"));const t=F,r=h?C:q,{productsSearch:s}=await r({productIds:e,companyId:t,customerGroupId:ue}),n=(e=>{const t=[];return u.forEach((r=>{const{node:s}=r,n=e.find((e=>+s.productId===e.id));if(n){const{variants:e}=n;if(e.length>0){const r=e.find((e=>s.variantSku===e.sku&&+s.variantId==+e.variant_id));if(r){const{optionList:e,quantity:n}=s,a=e.map((e=>({optionId:e.product_option_id,optionValue:e.value})));t.push({optionSelections:a,allOptions:e,productId:parseInt(r.product_id,10)||0,quantity:n,variantId:parseInt(r.variant_id,10)||0})}}}})),t})(s||[]),a=await O(n);a&&!a.errors?I.success("",{jsx:Y({message:f("purchasedProducts.footer.productsAdded"),link:A,linkText:f("purchasedProducts.footer.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}):a&&a.errors?I.error(a.errors[0].message,{isClose:!0}):I.error("Error has occurred",{isClose:!0})}finally{Z(),p(!1)}},isDisabled:!z},{name:f("purchasedProducts.footer.addToQuote"),key:"add-selected-to-quote",handleClick:async()=>{p(!0),he();try{const e=u.filter((e=>{const{node:{variantSku:t}}=e;return""!==t&&null!=t})),t=u.filter((e=>{const{node:{variantSku:t}}=e;return!t}));if(t.length>0&&I.error(f("purchasedProducts.footer.cantAddProductsNoSku"),{isClose:!0}),t.length===u.length)return;const r=[];e.forEach((e=>{const{node:t}=e;r.includes(+t.productId)||r.push(+t.productId)}));const s=h?C:q,{productsSearch:n}=await s({productIds:r,companyId:F,customerGroupId:ue,currencyCode:_}),a=L(n);let i=!1,o="",d=!0;const c=[];if(e.forEach((e=>{const{node:{basePrice:t,optionList:r,variantSku:s,productId:n,productName:u,quantity:l,variantId:p,tax:h}}=e,x=xe(r),g=a.find((e=>+e.id==+n)),m=g?.variants.find((e=>e.sku===s));m||(o=f("purchasedProducts.footer.notFoundSku",{sku:s}),d=!1);const y={node:{id:w(),variantSku:m?.sku||s,variantId:p,productsSearch:g,primaryImage:m?.image_url||T,productName:u,quantity:+l||1,optionList:JSON.stringify(x),productId:n,basePrice:t,tax:h}};c.push(y),i=!0})),i=E(c),!d)return void I.error("",{jsx:Y({message:o,link:"",linkText:"",isOutLink:!1}),isClose:!0});i?(await B(c,"2"),Q(c),I.success("",{jsx:Y({message:f("purchasedProducts.footer.productsAddedToQuote"),link:"/quoteDraft",linkText:f("purchasedProducts.footer.viewQuote"),isOutLink:!1}),isClose:!0})):I.error("",{jsx:Y({message:f("purchasedProducts.footer.productsLimit"),link:"/quoteDraft",linkText:f("purchasedProducts.footer.viewQuote"),isOutLink:!1}),isClose:!0})}catch(e){J.error(e)}finally{p(!1)}},isDisabled:!x},{name:f("purchasedProducts.footer.addSelectedProductsToShoppingList"),key:"add-selected-to-shoppingList",handleClick:ye,isDisabled:!g}];m.useEffect((()=>{if(u.length>0){let e=0;u.forEach((r=>{const{node:{variantId:s,productsSearch:{variants:n},quantity:a,basePrice:i}}=r;if(n?.length){const r=t(n,+s)||+i;e+=r*+a}else e+=+i*+a})),se(1e3*e/1e3)}else se(0)}),[u]);let Pe={display:U?"initial":"flex",flexBasis:"100%"};return M&&(Pe={display:"flex",flexGrow:1,maxWidth:1775,margin:"auto"}),s.jsxs(s.Fragment,{children:[z||x||g?s.jsx(n,{sx:{position:"fixed",bottom:U&&l?"52px":0,left:0,backgroundColor:"#fff",width:"100%",padding:U?"0 0 1rem 0":"16px 0 16px",height:U?"8rem":"auto",marginLeft:0,display:"flex",flexWrap:"nowrap",zIndex:"1000"},container:!0,spacing:2,children:s.jsxs(n,{item:U,sx:Pe,children:[s.jsx(a,{sx:{width:263,display:U?"none":"block"}}),s.jsxs(a,{sx:{flex:1,display:"flex",alignItems:"center",paddingLeft:U?0:"50px",paddingRight:U?0:"80px"},children:[s.jsxs(a,{sx:{width:U?"100%":"calc(66.6667% + 32px)",display:"flex",zIndex:"999",justifyContent:"space-between",...pe},children:[s.jsx(i,{sx:{color:"#000000",fontSize:"16px",fontWeight:"400"},children:f("purchasedProducts.footer.selectedProducts",{quantity:u.length})}),s.jsxs(a,{sx:{display:"flex",alignItems:"center",flexWrap:U?"wrap":"nowrap",width:U?"100%":"auto"},children:[s.jsx(i,{variant:"h6",sx:{fontSize:"16px",fontWeight:"700",color:"#000000"},children:f("purchasedProducts.footer.subtotal",{subtotal:b(K)})}),s.jsxs(a,{sx:{display:"flex",alignItems:"center",marginTop:U?"0.5rem":0,marginLeft:U?0:"20px",width:U?"100%":"auto"},children:[s.jsx(v,{variant:"contained",ref:N,onClick:()=>{0===u.length?I.error(f("purchasedProducts.error.selectOneItem")):G(!0)},sx:{marginRight:U?"1rem":0,width:U?"100%":"auto"},endIcon:s.jsx(re,{}),children:f("purchasedProducts.footer.addSelectedTo")}),s.jsx(o,{id:"basic-menu",anchorEl:N.current,open:W,onClose:he,MenuListProps:{"aria-labelledby":"basic-button"},children:ke.length>0&&ke.map((e=>e.isDisabled?null:s.jsx(d,{onClick:()=>{e.handleClick()},children:e.name},e.key)))})]})]})]}),s.jsx(a,{sx:{width:"33.3333%",display:U?"none":"block"}})]})]})}):null,s.jsx(ee,{isOpen:ne,dialogTitle:f("purchasedProducts.footer.addToShoppingList"),onClose:me,onConfirm:async e=>{ce(!0);try{const t=[];u.forEach((e=>{const{node:r}=e;t.includes(+r.productId)||t.push(+r.productId)}));const r=[];u.forEach((e=>{const{node:{optionList:t,productId:s,quantity:n,variantId:a,productsSearch:i}}=e,o=xe(t),d=D(o,i);r.push({productId:+s,variantId:+a,quantity:+n,optionList:d})}));const s=h?V:$;await s({shoppingListId:+e,items:r}),I.success(f("purchasedProducts.footer.productsAddedToShoppingList"),{jsx:()=>ge(e),isClose:!0}),me()}catch(t){J.error(t)}finally{ce(!1)}},onCreate:()=>{ae(!1),oe(!0)},isLoading:de,setLoading:ce}),s.jsx(X,{open:ie,onChange:ye,onClose:fe})]})}function ye(e){const t=H(),{updateList:r=(()=>{}),quickAddToList:o,level:d=3,buttonText:c=t("purchasedProducts.quickAdd.addProductToList")}=e,u=k(F),l=k((({company:e})=>e.companyInfo.status)),[p,h]=m.useState(d),[x,g]=m.useState([]),[f,y]=m.useState(!1),P=(e,t)=>{new Array(e).fill(1).forEach(((e,r)=>t(r)))};m.useEffect((()=>{let e=[];P(p,(r=>{e=[...e,...R(r,t)]})),g(e)}),[p]);const[j]=ae(),{control:S,handleSubmit:b,getValues:C,formState:{errors:q},setError:O,setValue:A}=ie({mode:"all"}),L=e=>{const r={};let s=!0;return P(p,(n=>{const a=e[`sku-${n}`],i=e[`qty-${n}`];if(s=!1!==((e,r,s)=>{if(!r&&!s)return!0;let n=!0;const a=parseInt(s,10)||0;return r||(O(`sku-${e}`,{type:"manual",message:t("global.validate.required",{label:t("purchasedProducts.quickAdd.sku")})}),n=!1),s?a<=0&&(O(`qty-${e}`,{type:"manual",message:"incorrect number"}),n=!1):(O(`qty-${e}`,{type:"manual",message:t("global.validate.required",{label:t("purchasedProducts.quickAdd.qty")})}),n=!1),n})(n,a,i)&&s,s&&a){const e=parseInt(i,10)||0;r[a]=r[a]?r[a]+e:e}})),{skuValue:r,isValid:s,skus:Object.keys(r)}},w=(e,t,r,s)=>{t.forEach((t=>{const n=Object.keys(e).find((r=>e[r]===t))||"";n&&O(n.replace("sku",r),{type:"manual",message:s})}))},T=()=>{j&&0===l?I.info("Your business account is pending approval. This feature is currently disabled."):b((async e=>{try{y(!0);const{skuValue:s,isValid:n,skus:a}=L(e);if(!n||a.length<=0)return;const i=await(async e=>{const t=u?z:M;try{const{variantSku:r}=await t({skus:e},!0);return r}catch(r){return[]}})(a),{notFoundSku:d,notPurchaseSku:c,productItems:l,passSku:p,notStockSku:h,orderLimitSku:x}=((e,t,r)=>{const s=[],n=[],a=[],i=[],o=[],d=[];return r.forEach((r=>{const c=(e||[]).find((e=>e.variantSku.toUpperCase()===r.toUpperCase()));if(!c)return void s.push(r);const{productId:u,variantId:l,option:p,purchasingDisabled:h="1",stock:x,isStock:g,maxQuantity:m,minQuantity:f}=c,y=t[r]||0;if("1"===h)return void n.push(r);if("1"===g&&y>+x)return void o.push({sku:r,stock:+x});if(0!==m&&0!==f&&y>0&&(y>m||y<f))return void d.push({sku:r,min:y<f?f:0,max:y>m?m:0});const k=(p||[]).reduce(((e,t)=>{try{const r="string"==typeof t?JSON.parse(t):t;return e.push({optionId:`attribute[${r.option_id}]`,optionValue:`${r.id}`}),e}catch(r){return e}}),[]);i.push(r),a.push({...c,newSelectOptionList:k,productId:parseInt(u,10)||0,quantity:y,variantId:parseInt(l,10)||0})})),{notFoundSku:s,notPurchaseSku:n,notStockSku:o,productItems:a,passSku:i,orderLimitSku:d}})(i,s,a);if(d.length>0&&(w(e,d,"sku",""),I.error(t("purchasedProducts.quickAdd.notFoundSku",{notFoundSku:d.join(",")}),{isClose:!0})),c.length>0&&(w(e,c,"sku",""),I.error(t("purchasedProducts.quickAdd.notPurchaseableSku",{notPurchaseSku:c.join(",")}),{isClose:!0})),h.length>0){const r=h.map((e=>e.sku));h.forEach((t=>{const{sku:r,stock:s}=t;w(e,[r],"qty",`${s} in stock`)})),I.error(t("purchasedProducts.quickAdd.insufficientStockSku",{stockSku:r.join(",")}),{isClose:!0})}x.length>0&&x.forEach((r=>{const{min:s,max:n,sku:a}=r,i=0===s?n:s;w(e,[a],"qty",`${0===s?"Max":"Min"} is ${i}`);const o=0===s?"maximum":"minimum";I.error(t("purchasedProducts.quickAdd.purchaseQuantityLimitMessage",{typeText:o,limit:i,sku:a}),{isClose:!0})})),l.length>0&&(await o(l),((e,t)=>{t.forEach((t=>{const r=Object.keys(e).find((r=>e[r]===t))||"";r&&(A(r,""),A(r.replace("sku","qty"),""))}))})(e,p),r())}finally{y(!1)}}))()};return s.jsx(_,{isSpinning:f,spinningHeight:"auto",children:s.jsxs(a,{sx:{width:"100%"},children:[s.jsxs(n,{container:!0,sx:{margin:"16px 0"},children:[s.jsx(n,{item:!0,sx:{flex:1,display:"flex",alignItems:"center"},children:s.jsx(i,{sx:{color:"#000"},variant:"body1",children:t("purchasedProducts.quickAdd.title")})}),s.jsx(n,{item:!0,children:s.jsx(v,{variant:"text",sx:{textTransform:"initial",ml:"-8px"},onClick:()=>{h(p+d)},children:t("purchasedProducts.quickAdd.showMoreRowsButton")})})]}),s.jsx(a,{onKeyDown:e=>{"Enter"===e.key&&T()},sx:{"& label":{zIndex:0}},children:s.jsx(oe,{formFields:x,errors:q,control:S,getValues:C,setValue:A})}),s.jsx(v,{variant:"outlined",fullWidth:!0,disabled:f,onClick:T,sx:{margin:"20px 0"},children:s.jsx(_,{isSpinning:f,tip:"",size:16,children:s.jsx(a,{sx:{flex:1,textAlign:"center"},children:c})})})]})})}function ke(e){const{isB2BUser:t}=e,[r]=S(),n=H(),[o,d]=m.useState(!1),[c,x]=m.useState([]),[g,f]=m.useState("Add to cart"),[y,P]=m.useState(!1),[j]=ae(),b=k((({company:e})=>e.companyInfo.status)),C=k((({global:e})=>e.blockPendingQuoteNonPurchasableOOS.isEnableProduct)),q=async e=>{const t=await O(e);return t&&t.errors?I.error(t.errors[0].message,{isClose:!0}):I.success("",{jsx:Y({message:n("purchasedProducts.quickOrderPad.productsAdded"),link:A,linkText:n("purchasedProducts.quickOrderPad.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}),Z(),t};return m.useEffect((()=>{c?.length>0&&f(n("purchasedProducts.quickOrderPad.addNProductsToCart",{quantity:c.length}))}),[c]),s.jsxs(u,{sx:{marginBottom:r?"8.5rem":"50px"},children:[s.jsx(l,{children:s.jsxs(a,{children:[s.jsx(i,{variant:"h5",sx:{marginBottom:"1rem"},children:n("purchasedProducts.quickOrderPad.quickOrderPad")}),s.jsx(se,{addToList:async e=>{const t=(e=>{const{variantId:t,variants:r,inventoryLevel:s,inventoryTracking:a,orderQuantityMaximum:i,orderQuantityMinimum:o,quantity:d,sku:c}=e,u="none"!==a;let l=!1,p=s,h=c;const x=r.find((e=>+e.variant_id==+t));return x&&(l=x.purchasing_disabled,p="variant"===a?x.inventory_level:p,h=x.sku||c),l&&!C?(I.error(n("purchasedProducts.quickOrderPad.notPurchaseableSku",{notPurchaseSku:h})),!1):u&&+d>+p?(I.error(n("purchasedProducts.quickOrderPad.insufficientStockSku",{sku:h}),{isClose:!0}),!1):+o>0&&+d<o?(I.error(n("purchasedProducts.quickOrderPad.minQuantityMessage",{minQuantity:o,sku:h}),{isClose:!0}),!1):!(+i>0&&+d>+i&&(I.error(n("purchasedProducts.quickOrderPad.maxQuantityMessage",{maxQuantity:i,sku:h}),{isClose:!0}),1))})(e[0]);try{t&&await q(e)}catch(r){J.error(r)}return e},searchDialogTitle:n("purchasedProducts.quickOrderPad.quickOrderPad"),type:"quickOrder",addButtonText:n("purchasedProducts.quickOrderPad.addToCart"),isB2BUser:t}),s.jsx(p,{}),s.jsx(ye,{quickAddToList:q,buttonText:n("purchasedProducts.quickOrderPad.addProductsToCart")}),s.jsx(p,{}),s.jsx(a,{sx:{margin:"20px 0 0"},children:s.jsxs(v,{variant:"text",onClick:()=>{j&&0===b?I.info(n("purchasedProducts.quickOrderPad.addNProductsToCart")):d(!0)},children:[s.jsx(ne,{sx:{marginRight:"8px"}}),n("purchasedProducts.quickOrderPad.bulkUploadCSV")]})})]})}),s.jsx(U,{isOpen:o,setIsOpen:d,handleAddToList:async e=>{P(!0);try{const{stockErrorFile:t,validProduct:r}=e,{notPurchaseSku:a,productItems:i,limitProduct:o,minLimitQuantity:c,maxLimitQuantity:u,outOfStock:l}=(e=>{const t=[],r=[],s=[],n=[],a=[],i=[];return e.forEach((e=>{const{products:o,qty:d}=e,{option:c,isStock:u,stock:l,purchasingDisabled:p,maxQuantity:h,minQuantity:x,variantSku:g,variantId:m,productId:f,modifiers:y}=o;if("1"===p||p)return void t.push(g);if("1"===u&&0===l)return void i.push(g);if("1"===u&&l>0&&l<+d)return void s.push({variantSku:g,AvailableAmount:l});if(+x>0&&+d<+x)return void n.push({variantSku:g,minQuantity:x});if(+h>0&&+d>+h)return void a.push({variantSku:g,maxQuantity:h});const k=c.map((e=>({optionId:e.option_id,optionValue:e.id})));r.push({productId:parseInt(f,10)||0,variantId:parseInt(m,10)||0,quantity:+d,optionSelections:k,allOptions:y})})),{notPurchaseSku:t,productItems:r,limitProduct:s,minLimitQuantity:n,maxLimitQuantity:a,outOfStock:i}})(r);i.length>0&&((e=>{e&&!e.errors?I.success("",{jsx:Y({message:n("purchasedProducts.quickOrderPad.productsAdded"),link:A,linkText:n("purchasedProducts.quickOrderPad.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}):I.error("Error has occurred",{isClose:!0})})(await O(i)),Z()),o.length>0&&o.forEach((e=>{I.warning("",{jsx:()=>(e=>s.jsxs(s.Fragment,{children:[s.jsx("p",{style:{margin:0},children:n("purchasedProducts.quickOrderPad.notEnoughStock",{variantSku:e.variantSku})}),s.jsx("p",{style:{margin:0},children:n("purchasedProducts.quickOrderPad.availableAmount",{availableAmount:e.AvailableAmount})})]}))(e)})})),a.length>0&&I.error(n("purchasedProducts.quickOrderPad.notPurchaseableSku",{notPurchaseSku:a.join(",")}),{isClose:!0}),l.length>0&&t&&I.error("",{jsx:()=>((e,t)=>s.jsxs(s.Fragment,{children:[s.jsx("p",{style:{margin:0},children:n("purchasedProducts.quickOrderPad.outOfStockSku",{outOfStock:e.join(",")})}),s.jsx(h,{href:t,sx:{color:"#FFFFFF"},children:n("purchasedProducts.quickOrderPad.downloadErrorsCSV")})]}))(l,t),isClose:!0}),c.length>0&&c.forEach((e=>{I.error(n("purchasedProducts.quickOrderPad.minQuantityMessage",{minQuantity:e.minQuantity,sku:e.variantSku}),{isClose:!0})})),u.length>0&&u.forEach((e=>{I.error(n("purchasedProducts.quickOrderPad.maxQuantityMessage",{maxQuantity:e.maxQuantity,sku:e.variantSku}),{isClose:!0})})),d(!1)}finally{P(!1)}},setProductData:x,addBtnText:g,isLoading:y,isToCart:!0})]})}const Pe=x("img")((()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})));function je(e){const{item:t,checkBox:r,handleUpdateProductQty:n}=e,o=H(),{quantity:d,imageUrl:c,productName:u,variantSku:p,optionList:h,basePrice:x,lastOrderedAt:m,variantId:f,productsSearch:y}=t,k=+x*+d,P=y.variants||[],j=de(P,{variantId:f})||c;return s.jsx(a,{sx:{borderTop:"1px solid #D9DCE9"},children:s.jsxs(l,{sx:{color:"#313440",display:"flex",pl:0},children:[s.jsx(a,{children:r&&r()}),s.jsx(a,{children:s.jsx(Pe,{src:j||T,alt:"Product-img",loading:"lazy"})}),s.jsxs(a,{sx:{flex:1},children:[s.jsx(i,{variant:"body1",color:"#212121",children:u}),s.jsx(i,{variant:"body1",color:"#616161",children:p}),s.jsx(a,{sx:{margin:"1rem 0"},children:h.length>0&&s.jsx(a,{children:h.map((e=>s.jsx(i,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:`${e.display_name}: ${e.display_value}`},e.display_name)))})}),s.jsx(i,{sx:{fontSize:"14px"},children:o("purchasedProducts.quickOrderCard.price",{price:b(k)})}),s.jsx(a,{sx:{"& label":{zIndex:0}},children:s.jsx(g,{size:"small",type:"number",variant:"filled",label:"Qty",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:d,sx:{margin:"1rem 0",width:"60%",maxWidth:"100px","& label":{fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:e=>{n(t.id,e.target.value)}})}),s.jsx(i,{sx:{fontSize:"14px"},children:o("purchasedProducts.quickOrderCard.lastOrdered",{lastOrderedAt:N(m)})})]})]})},t.id)}const Se=x("img")((()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}))),be=x(a)((()=>({display:"flex",flexDirection:"column",width:"100%","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{paddingTop:"25px"}}}}))),ve=x(g)((()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}}))),Ie="lastOrderedAt",Ce={product:"productName",lastOrderedAt:"lastOrderedAt"};function qe({setIsRequestLoading:e,setCheckedArr:r,isRequestLoading:n}){const o=m.useRef(null),d=k(F),c=k((({company:e})=>e.companyInfo.id)),u=k((({company:e})=>e.customer.customerGroupId)),[l,p]=m.useState({q:"",beginDateAt:ce(90),endDateAt:ce(0),orderBy:`-${Ce[Ie]}`}),[h,x,g]=pe(Ce,Ie,l,p),[f,y]=m.useState(0),[j]=S(),v=H(),{currency_code:O}=k(P),A=(e,t)=>{if(""!==t&&+t<=0)return;const r=o.current?.getList()||[],s=o.current?.getCacheList()||[],n=r?.map((r=>{const{node:s}=r;return s?.id===e&&(s.quantity=+t||""),r})),a=s?.map((r=>{const{node:s}=r;return s?.id===e&&(s.quantity=+t||""),r}));o.current?.setList([...n]),o.current?.setCacheAllList([...a])},w=(e,t)=>{const{productsSearch:{isPriceHidden:r}}=t;return r?"":G({price:e,productInfo:t,showText:r?"":e,forcedSkip:!0})},E=e=>{const t=o.current?.getCacheList()||[];let r=e.quantity;if(t.length>0){const s=t.find((t=>t.node.variantId===e.variantId&&t.node.productId===e.productId&&t.node.id===e.id));s&&s.node&&(r=s.node.quantity||r)}return r},B=[{key:"product",title:v("purchasedProducts.product"),render:e=>{const{optionList:t,productsSearch:r,variantId:n}=e,o=r.variants||[],d=de(o,{variantId:n})||e.imageUrl;return s.jsxs(a,{sx:{display:"flex",alignItems:"flex-start"},children:[s.jsx(Se,{src:d||T,alt:"Product-img",loading:"lazy"}),s.jsxs(a,{children:[s.jsx(i,{variant:"body1",color:"#212121",children:e.productName}),s.jsx(i,{variant:"body1",color:"#616161",children:e.variantSku}),t.length>0&&s.jsx(a,{children:t.map((e=>s.jsx(i,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:`${e.display_name}: ${e.display_value}`},e.id)))})]})]})},width:"40%",isSortable:!0},{key:"price",title:v("purchasedProducts.price"),render:e=>{const{productsSearch:{variants:r},variantId:n,basePrice:a}=e;let o=+a;r?.length&&(o=t(r,+n)||+a);const d=(o||+a)*+E(e);return s.jsx(i,{sx:{padding:"12px 0"},children:`${w(b(d),e)}`})},width:"15%",style:{textAlign:"right"}},{key:"qty",title:v("purchasedProducts.qty"),render:e=>{const t=E(e);return s.jsx(ve,{size:"small",type:"number",variant:"filled",value:t,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:t=>{A(e.id,t.target.value)}})},width:"15%",style:{textAlign:"right"}},{key:"lastOrderedAt",title:v("purchasedProducts.lastOrdered"),render:e=>s.jsx(a,{children:s.jsx(i,{sx:{padding:"12px 0"},children:`${N(+e.lastOrderedAt)}`})}),width:"15%",style:{textAlign:"right"},isSortable:!0}];return s.jsx(_,{isSpinning:n,children:s.jsxs(be,{children:[s.jsx(i,{sx:{fontSize:"24px",height:"50px"},children:v("purchasedProducts.totalProducts",{total:f})}),s.jsxs(a,{sx:{marginBottom:"5px",display:"flex","& label":{zIndex:0}},children:[s.jsxs(a,{sx:{width:j?"100%":"40%",mr:"20px",display:"flex",justifyContent:j?"space-between":"flex-start"},children:[s.jsx(he,{h:"48px",searchBGColor:"rgba(0, 0, 0, 0.06)",handleChange:e=>{(async e=>{p({...l,q:e})})(e)}}),j&&s.jsx(a,{sx:{display:"flex",alignItems:"center"},children:s.jsx(ue,{fiterMoreInfo:[],startPicker:{isEnabled:!0,label:v("purchasedProducts.from"),defaultValue:l?.beginDateAt||"",pickerKey:"start"},endPicker:{isEnabled:!0,label:v("purchasedProducts.to"),defaultValue:l?.endDateAt||"",pickerKey:"end"},isShowMore:!0,onChange:e=>{const t={...l};t.beginDateAt=e.startValue,t.endDateAt=e.endValue,p(t)}})})]}),!j&&s.jsx(le,{handleChange:(e,t)=>{const r={...l};"start"===e?r.beginDateAt=t||ce(90):r.endDateAt=t||ce(0),p(r)},xs:{mt:0,height:"50px"},startPicker:{isEnabled:!0,label:v("purchasedProducts.from"),defaultValue:ce(90),pickerKey:"start"},endPicker:{isEnabled:!0,label:v("purchasedProducts.to"),defaultValue:ce(),pickerKey:"end"},customWidth:"58%"})]}),s.jsx(W,{ref:o,columnItems:B,rowsPerPageOptions:[12,24,36],getRequestList:async e=>{const{orderedProducts:{edges:t,totalCount:r}}=d?await ge(e):await me(e),s=await(async e=>{if(e.length>0){const r=[];e.forEach((e=>{const{node:t}=e;t.quantity=1,r.includes(t.productId)||r.push(t.productId)}));const s=d?C:q;try{const{productsSearch:t}=await s({productIds:r,currencyCode:O,companyId:c,customerGroupId:u}),n=L(t);return e.forEach((e=>{const{node:t}=e,r=n.find((e=>{const{id:r}=e;return+t.productId==+r}));t.productsSearch=r||{}})),e}catch(t){I.error(t)}}return[]})(t);return y(r),{edges:s,totalCount:r}},searchParams:l,isCustomRender:!1,showCheckbox:!0,showSelectAllCheckbox:!0,disableCheckbox:!1,hover:!0,labelRowsPerPage:v("purchasedProducts.itemsPerPage"),showBorder:!1,requestLoading:e,getSelectCheckbox:e=>{if(e.length>0){const t=o.current?.getCacheList()||[],s=e.map((e=>t.find((t=>{const{node:r}=t;return r.id===e}))));r([...s])}else r([])},itemIsMobileSpacing:0,isSelectOtherPageCheckbox:!0,noDataText:v("purchasedProducts.noProductsFound"),sortDirection:x,orderBy:g,sortByFn:h,renderItem:(e,t,r)=>s.jsx(je,{item:e,checkBox:r,handleUpdateProductQty:A})})]})})}}}}));
