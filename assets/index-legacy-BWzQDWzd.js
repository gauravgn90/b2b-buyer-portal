System.register(["./mui-legacy-BDTphHaF.js","./reactVendor-legacy-CtYIj4Ma.js","./form-legacy-CAo5v63e.js","./lang-legacy-C2M9M2Og.js","./eStyled-legacy-D59194a7.js","./lodashEs-legacy-Da1qF4L1.js","./B3Card-legacy-BY5_Dxor.js","./B3CustomForm-legacy-BVFdU8az.js","./react-setup-legacy-Bwwh9_Jr.js","../index-legacy.BPYbSXo1.js","./b3Logger-legacy-C5y5ZQF8.js","./b3Login-legacy-S-vwXiE2.js","./RegisteredFinish-legacy-DrbeUWEQ.js","./config-legacy-bN_WP51o.js","./router-legacy-CCJEjNy7.js","./eReact-legacy-BRtOBtIF.js","./intl-legacy-DG3cM9-L.js","./eCache-legacy-BoIqTPuc.js","./redux-legacy-Dls004SH.js","./toolkit-legacy-6OFItfV5.js","./muiIcon-legacy-BXgwC5sb.js","./dateFns-legacy-DV9BM4UY.js","./dropzone-legacy-B_7NAEdu.js","./validatorRules-legacy-DhhIqtMN.js"],(function(e,t){"use strict";var a,s,n,r,l,o,i,c,d,u,m,f,g,p,h,y,b,x,j,F,w,C,S,T,E,I,B,N,L,V,k,v,A,M,R,z,q,O,P,D,W,$,_;return{setters:[e=>{a=e.j,s=e.B,n=e.a3,r=e.$},e=>{l=e.r},e=>{o=e.u},e=>{i=e.u},e=>{c=e.n},e=>{d=e.i},e=>{u=e.B},e=>{m=e.B},e=>{f=e.a,g=e.G,p=e.u,h=e.bs,y=e.C,b=e.k,x=e.a2,j=e.a3,F=e.a4,w=e.ad,C=e.x,S=e.bo,T=e.a6,E=e.bt,I=e.a8},null,e=>{B=e.b},e=>{N=e.l},e=>{L=e.d,V=e.e,k=e.b,v=e.f,A=e.T,M=e.I,R=e.a,z=e.v},e=>{q=e.s,O=e.b,P=e.g,D=e.d,W=e.t,$=e.B},e=>{_=e.u},null,null,null,null,null,null,null,null,null],execute:function(){e("default",(function(e){const[c,U]=l.useState(""),[G,H]=l.useState(!1),{setOpenPage:Y}=e,Z=i(),[J]=f(),{control:K,handleSubmit:Q,getValues:X,formState:{errors:ee},setValue:te,setError:ae,watch:se}=o({mode:"onSubmit"}),{state:{storeName:ne,logo:re,blockPendingAccountOrderCreation:le,registerEnabled:oe}}=l.useContext(g),ie=_(),ce=p((({company:e})=>e.customer)),{id:de,firstName:ue,lastName:me,emailAddress:fe,phoneNumber:ge}=ce,{state:pe,dispatch:he}=l.useContext(h),{state:{companyAutoApproval:ye,portalStyle:{backgroundColor:be="#FEF9F5"}}}=l.useContext(y),xe=b(be),je=(e=!1)=>{he({type:"loading",payload:{isLoading:e}})};l.useEffect((()=>{je(!1),oe||ie("/login")}),[oe]),l.useEffect((()=>{(async()=>{try{he&&(je(!0),he({type:"finishInfo",payload:{submitSuccess:!1}}));const e=await F(3),t=(e?.accountFormFields||[]).map((e=>{const t=e;return O.includes(e?.fieldId||"")&&4===e.groupId&&(t.isRequired=!0,t.visible=!0),e})),a=P(t||[]),{countries:s}=await w(),n=a.address.map((e=>{const t=e;return"country"===e.name&&(t.options=s,t.replaceOptions={label:"countryName",value:"countryName"}),e})),r={phone:ge,first_name:ue,last_name:me,email:fe},l=a.contactInformation.map((e=>{const t=e;return t.disabled=!0,t.default=r[D(e.name)]||e.default,e.required&&!e?.default&&(t.disabled=!1),e}));he&&he({type:"all",payload:{isLoading:!1,storeName:ne,bcTob2bContactInformation:[...l],bcTob2bCompanyExtraFields:[],bcTob2bCompanyInformation:[...a.businessDetails],bcTob2bAddressBasicFields:[...n],countryList:[...s]}})}catch(e){B.error(e)}})()}),[]);const{bcTob2bContactInformation:Fe,isLoading:we,bcTob2bCompanyInformation:Ce=[],bcTob2bAddressBasicFields:Se=[],countryList:Te=[],bcTob2bCompanyExtraFields:Ee=[]}=pe;l.useEffect((()=>{const e=(e,t="")=>{const a=Te.find((t=>t.countryCode===e||t.countryName===e))?.states||[],s=Se.find((e=>"state"===e.name));s&&(a.length>0?(s.fieldType="dropdown",s.options=a):(s.fieldType="text",s.options=[])),te("state",t&&e&&(a.find((e=>e.stateCode===t))||0===a.length)?t:""),he({type:"stateList",payload:{stateList:a,bcTob2bAddressBasicFields:[...Se]}})};(()=>{const t=X("country"),a=X("state");e(t,a)})();const t=se(((t,{name:a,type:s})=>{const{country:n,state:r}=t;"country"===a&&"change"===s&&e(n,r)}));return()=>t.unsubscribe()}),[Te]);const Ie=async e=>{try{const t=await z({extraFields:e});if(200!==t.code){const e=t.data?.errMsg||t.message||"",a=e.split(":");if(a.length>=2){const e=Fe?.find((e=>e.custom&&$.decode(e.name)===a[0]));if(e)return ae(e.name,{type:"manual",message:a[1]}),(e=>{if(Fe){const t=Fe.map((t=>t.name===e?{...t,disabled:!1}:t));he&&he({type:"all",payload:{bcTob2bContactInformation:[...t]}})}})(e.name),je(!1),!1}return U(e),je(!1),!1}return U(""),!0}catch(t){return!1}};return a.jsx(u,{setOpenPage:Y,children:a.jsx(L,{isMobile:J,children:a.jsx(x,{isSpinning:we,tip:Z("global.tips.loading"),transparency:"0",children:a.jsxs(s,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center","& h4":{color:xe},"& input, & .MuiFormControl-root .MuiTextField-root, & .MuiDropzoneArea-textContainer, & .MuiSelect-select.MuiSelect-filled, & .MuiTextField-root .MuiInputBase-multiline":{borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}},children:[re&&a.jsx(V,{children:a.jsx(n,{sx:{maxWidth:"250px"},onClick:()=>{window.location.href="/"},children:a.jsx("img",{src:`${re}`,alt:Z("global.tips.registerLogo"),loading:"lazy"})})}),G?a.jsx(k,{activeStep:q.length,handleFinish:()=>{N(ie,!0)&&(ye.enabled?ie("/orders"):window.location.href="/")},isBCToB2B:!0}):a.jsxs(t,{sx:{width:J?"100%":"537px",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px",marginTop:"1rem",background:"#FFFFFF",padding:"0 0.8rem 1rem 0.8rem"},children:[a.jsx(v,{children:Z("registeredbctob2b.title")}),c&&a.jsx(r,{severity:"error",children:a.jsx(A,{children:c})}),a.jsxs(s,{sx:{width:"100%"},children:[a.jsx(M,{children:Fe?.length?Fe[0]?.groupName:""}),a.jsx(m,{formFields:Fe||[],errors:ee,control:K,getValues:X,setValue:te})]}),a.jsxs(s,{sx:{width:"100%"},children:[a.jsx(M,{children:Ce?.length?Ce[0]?.groupName:""}),a.jsx(m,{formFields:[...Ce,...Ee],errors:ee,control:K,getValues:X,setValue:te,setError:ae})]}),a.jsxs(s,{sx:{width:"100%"},children:[a.jsx(M,{children:Se?.length?Se[0]?.groupName:""}),a.jsx(m,{formFields:Se,errors:ee,control:K,getValues:X,setValue:te})]}),!G&&a.jsx(s,{sx:{display:"flex",flexDirection:"row-reverse",pt:2,width:"100%"},children:a.jsx(j,{variant:"contained",onClick:e=>{const t=(()=>{const e=X(),t=Ce.find((e=>"field_attachments"===e.fieldId));return!(d(t)||!t.required||0!==e[t.name].length||(ae(t.name,{type:"required",message:Z("global.validate.required",{label:t.label??""})}),je(!1),0))})();Q((async e=>{if(!t){je(!0);try{const t=await(async e=>{try{const t=Ce.filter((e=>!!e.custom)),a=t.map((t=>({fieldName:D(t.name),fieldValue:e[t.name]||t.default}))),s=await R({extraFields:a});if(200!==s.code){const e=s.data?.errMsg||s.message||"",a=e.split(":");if(a.length>=2){const e=t.find((e=>D(e.name)===a[0]));if(e)return ae(e.name,{type:"manual",message:a[1]}),je(!1),!1}throw e}return U(""),!0}catch(t){throw B.error(t),t}})(e);if(!t)return;const a=(Fe||[]).filter((e=>!!e.custom)),s=[];a.length&&a.forEach((t=>{const a={};a.fieldName=D(t.name),a.fieldValue=e[t.name]||t?.default||"",s.push(a)}));let n=!0;if(s.length>0&&(n=await Ie(s)),!n)return;const r=Ce.filter((e=>"files"===e.fieldType)),l=await(async(e,t)=>{let a=[];if(e.length){e.forEach((e=>{a=t[e.name]||[]}));try{return(await Promise.all(a.map((e=>S({file:e,type:"companyAttachedFile"}))))).reduce(((e,t)=>{let a=e;if(200!==t.code)throw t.data.errMsg||t.message||Z("intl.global.fileUpload.fileUploadFailure");{const s={...t.data};s.fileSize=s.fileSize?`${s.fileSize}`:"",a=[...e,s]}return a}),[])}catch(s){throw B.error(s),s}}})(r||[],e);await(async(e,t,a,s)=>{const n={};n.customerId=t||"",n.storeHash=I,n.userExtraFields=s;const r=Ce.filter((e=>!e.custom&&"files"!==e.fieldType)),l=Ce.filter((e=>!!e.custom));if(r.length&&r.forEach((t=>{n[W(D(t.name))]=e[t.name]||""})),l.length){const t=[];l.forEach((a=>{const s={};s.fieldName=D(a.name),s.fieldValue=e[a.name]||"",t.push(s)})),n.extraFields=t}const o=Se.filter((e=>!e.custom)),i=Se.filter((e=>!!e.custom));if(o.length&&o.forEach((t=>{const a=D(t.name);"address1"===a&&(n.addressLine1=e[t.name]||""),"address2"===a&&(n.addressLine2=e[t.name]||""),n[a]=e[t.name]||""})),i.length){const t=[];i.forEach((a=>{const s={};s.fieldName=D(a.name),s.fieldValue=e[a.name]||"",t.push(s)})),n.addressExtraFields=t}return n.fileList=a,n.channelId=T,E(n)})(e,de,l,s);const o=ye.enabled;fe&&(he({type:"finishInfo",payload:{submitSuccess:!0,isAutoApproval:o,blockPendingAccountOrderCreation:le}}),he({type:"all",payload:{accountType:"1"}}),await C(),H(!0))}catch(a){B.error(a),U(a?.message||a)}finally{je(!1)}}}))(e)},children:Z("global.button.submit")})})]})]})})})})}));const t=e("StyledRegisterContent",c(s)({"& #b3-customForm-id-name":{'& label[data-shrink="true"]':{whiteSpace:"break-spaces",minWidth:"calc(133% - 24px)",transition:"unset"},'& label[data-shrink="false"]':{whiteSpace:"break-spaces"}}}))}}}));
