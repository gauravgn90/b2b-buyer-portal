System.register(["./mui-legacy-BDTphHaF.js","./reactVendor-legacy-CtYIj4Ma.js","./router-legacy-CCJEjNy7.js","./lang-legacy-C2M9M2Og.js","./B3Card-legacy-BY5_Dxor.js","./react-setup-legacy-Bwwh9_Jr.js","./b3Logger-legacy-C5y5ZQF8.js","../index-legacy.BPYbSXo1.js","./b3Login-legacy-S-vwXiE2.js","./login-legacy-DX2Xzgpj.js","./config-legacy-Zj7G9CKI.js","./form-legacy-CAo5v63e.js","./B3CustomForm-legacy-BVFdU8az.js","./styled-legacy-BiAb5OK7.js","./eReact-legacy-BRtOBtIF.js","./intl-legacy-DG3cM9-L.js","./eCache-legacy-BoIqTPuc.js","./eStyled-legacy-D59194a7.js","./redux-legacy-Dls004SH.js","./toolkit-legacy-6OFItfV5.js","./lodashEs-legacy-Da1qF4L1.js","./muiIcon-legacy-BXgwC5sb.js","./dateFns-legacy-DV9BM4UY.js","./dropzone-legacy-B_7NAEdu.js","./validatorRules-legacy-DhhIqtMN.js"],(function(e,t){"use strict";var n,o,i,s,r,a,l,c,d,g,u,x,p,m,f,y,h,j,b,w,T,C,B,F,I,S,v,H,L,k,R,A,P,D,E,q,U,M,O,V,_,z,W,N,J,G,Y,Z,$;return{setters:[e=>{n=e.j,o=e.B,i=e.x,s=e.T,r=e.$,a=e.a3},e=>{l=e.r},e=>{c=e.u,d=e.d},e=>{g=e.u},e=>{u=e.B},e=>{x=e.a3,p=e.k,m=e.a,f=e.i,y=e.u,h=e.as,j=e.G,b=e.C,w=e.at,T=e.a2,C=e.n,B=e.o,F=e.a5,I=e.au,S=e.av,v=e.aw,H=e.ax,L=e.a8,k=e.a6,R=e.w,A=e.ah,P=e.ay,D=e.az,E=e.x,q=e.aA,U=e.ab,M=e.aB,O=e.aC},e=>{V=e.b},null,e=>{_=e.l},e=>{z=e.b,W=e.a},e=>{N=e.a,J=e.l},e=>{G=e.u},e=>{Y=e.B},e=>{Z=e.a,$=e.L},null,null,null,null,null,null,null,null,null,null,null],execute:function(){function t(e){const{html:t,sx:i}=e;return n.jsx(o,{sx:{...i},dangerouslySetInnerHTML:{__html:t}})}function K(e){const{loginBtn:t,handleLoginSubmit:r,gotoForgotPassword:a,backgroundColor:l}=e,c=g(),d=i(),{control:u,handleSubmit:m,getValues:f,formState:{errors:y},setValue:h}=G({mode:"onSubmit"}),j=e=>{r(e)},b=N(c,m(j));return n.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[n.jsx(s,{variant:"h5",sx:{margin:"20px 0",display:"flex",justifyContent:"center",alignItems:"center"},children:c("login.loginText.signInHeader")}),n.jsx(o,{sx:{width:"100%","& input":{bgcolor:"#F5F5F5",borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}},children:n.jsxs("form",{onSubmit:m(j),children:[n.jsx(Y,{formFields:b,errors:y,control:u,getValues:f,setValue:h}),n.jsxs(o,{sx:{display:"flex",justifyContent:"flex-start ",alignItems:"center",mt:2},children:[n.jsx(x,{type:"submit",variant:"contained",sx:{backgroundColor:d.palette.primary.main},children:t}),n.jsx(o,{sx:{cursor:"pointer",ml:2,textDecoration:"underline",textUnderlineOffset:"4px",color:p(l)},onClick:()=>a(),children:c("login.loginText.forgotPasswordText")})]})]})})]})}function Q(e){const{handleSubmit:s,widgetBodyText:r,createAccountButtonText:a}=e,l=i(),[c]=m();return n.jsxs(o,{sx:{padding:c?"16px":"20px",borderRadius:"4px",mt:c?"0":"-25px"},children:[n.jsx(t,{sx:{minHeight:"250px","& .panel":{".panel-title":{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",fontWeight:400,fontSize:"24px"}}},html:r}),n.jsx(o,{sx:{marginTop:"5px"},children:n.jsx(x,{type:"submit",onClick:s,variant:"contained",sx:{ml:c?0:1,backgroundColor:l.palette.primary.main},children:a})})]})}e("default",(function(e){const{isMasquerade:i,endMasquerade:s}=X(),{setOpenPage:x}=e,p=f(),C=y(h),B=y((({quoteInfo:e})=>e.quoteDetailToCheckoutUrl)),[N,G]=l.useState(!0),[Y]=m(),[te,ne]=l.useState(!0),[oe,ie]=l.useState(""),[se,re]=l.useState({emailAddress:"",password:""}),ae=c(),le=g(),[ce,de]=d(),{state:{isCheckout:ge,logo:ue,registerEnabled:xe}}=l.useContext(j),{state:{loginPageButton:pe,loginPageDisplay:me,loginPageHtml:fe,portalStyle:{backgroundColor:ye="FEF9F5"}}}=l.useContext(b),{createAccountButtonText:he,primaryButtonColor:je,signInButtonText:be}=pe;console.log(pe);const{displayStoreLogo:we,pageTitle:Te}=me,{bottomHtmlRegionEnabled:Ce,bottomHtmlRegionHtml:Be,createAccountPanelHtml:Fe,topHtmlRegionEnabled:Ie,topHtmlRegionHtml:Se}=fe,ve={loginTitle:Te||le("login.button.signIn"),loginBtn:be||le("login.button.signInUppercase"),createAccountButtonText:he||le("login.button.createAccount"),btnColor:je||"",widgetHeadText:Ie?Se:void 0,widgetBodyText:Fe||w,widgetFooterText:Ce?Be:void 0,logo:we?ue:void 0};l.useEffect((()=>{(async()=>{try{const e=ce.get("loginFlag"),t="false"!==ce.get("showTip");if(ne(t),e&&ie(e),"7"===e&&F.error(le("login.loginText.invoiceErrorTip")),"3"===e&&C){const e=await I();if(e.data.site.cart?.entityId){const t=S(e.data.site.cart.entityId);await v(t)}const{result:t}=(await z()).data.logout;if("success"!==t)return;return i&&await s(),window.sessionStorage.clear(),H(),G(!1),void window.location.reload()}G(!1)}finally{G(!1)}})()}),[le,s,C,i,ce]);const He=(e,t="")=>{if(!e)return"";switch(e){case"1":return le("login.loginTipInfo.resetPassword",{email:t});case"2":return le("login.loginTipInfo.receivePassword");case"3":return le("login.loginTipInfo.loggedOutLogin");case"4":return le("login.loginTipInfo.accountincorrect");case"5":return le("login.loginTipInfo.accountPrelaunch");case"6":return le("login.loginText.deviceCrowdingLogIn");default:return""}},Le=async e=>{const t=await O(e);ie(t?"1":"4")},ke=xe?"100%":"50%",Re=xe?"50%":"auto";return n.jsx(u,{setOpenPage:x,children:n.jsx(Z,{paddings:Y?"0":"20px 20px",children:n.jsx(T,{isSpinning:N,tip:le("global.tips.loading"),background:"transparent",children:n.jsx(o,{sx:{display:"flex",flexDirection:"column",width:"100%",minHeight:"400px",minWidth:"343px"},children:ve&&n.jsxs(n.Fragment,{children:[oe&&te&&n.jsx(o,{sx:{padding:Y?0:"0 5%",margin:"30px 0 0 0"},children:He(oe,se?.emailAddress)&&n.jsx(r,{severity:ee(oe),variant:"filled",children:He(oe,se?.emailAddress||"")})}),B&&n.jsx(r,{severity:"error",variant:"filled",children:le("login.loginText.quoteDetailToCheckoutUrl")}),ve.logo&&n.jsx(o,{sx:{margin:"20px 0",minHeight:"150px"},children:n.jsx($,{children:n.jsx(a,{sx:{maxWidth:Y?"70%":"250px"},onClick:()=>{window.location.href="/"},children:n.jsx("img",{src:ve.logo,alt:le("login.registerLogo"),loading:"lazy"})})})}),ve.widgetHeadText&&n.jsx(t,{sx:{minHeight:"48px",width:xe||Y?"100%":"50%"},html:ve.widgetHeadText}),n.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:n.jsx(o,{sx:{bgcolor:"#FFFFFF",borderRadius:"4px",margin:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",width:Y?"auto":ke},children:n.jsxs(o,{sx:{mb:"20px",display:"flex",flexDirection:Y?"column":"row",justifyContent:"center",width:Y?"auto":"100%"},children:[n.jsx(o,{sx:{width:Y?"auto":Re,paddingRight:Y?0:"2%",ml:"16px",mr:Y?"16px":"",pb:xe?"":"36px"},children:n.jsx(K,{loginBtn:ve.loginBtn,gotoForgotPassword:()=>{ae("/forgotpassword")},handleLoginSubmit:async e=>{if(G(!0),re(e),de((e=>(e.delete("loginFlag"),e))),ge)try{await J(e),window.location.reload()}catch(t){V.error(t),Le(e.emailAddress)}else try{const t={email:e.emailAddress,password:e.password,storeHash:L,channelId:k},{login:{result:{token:n,storefrontLoginToken:o,permissions:i},errors:s}}=await W({loginData:t});if(p(R(n)),A.dispatch(P(i)),D(o),s?.[0]||!n){if(s?.[0]){const{message:e}=s[0];if("Operation cannot be performed as the storefront channel is not live"===e)return ie("5"),void G(!1)}Le(e.emailAddress)}else{const e=await E(n);if(B)return void ae(B);if(e?.userType===q.MULTIPLE_B2C&&e?.role===U.SUPER_ADMIN)return void ae("/dashboard");if(!_(ae))return;const{getShoppingListPermission:t,getOrderPermission:o}=M();if(e?.role===U.JUNIOR_BUYER&&"Junior Buyer"===e?.companyRoleName)ae(t?"/shoppingLists":"/accountSettings");else{let n=o?"/orders":"/shoppingLists";n=t||o?n:"/accountSettings",n=e?.userType===q.B2C?"/orders":n,ae(n)}}}catch(t){F.error(le("login.loginTipInfo.accountincorrect"))}finally{G(!1)}},backgroundColor:ye})}),xe&&n.jsx(o,{sx:{flex:"1",paddingLeft:Y?0:"2%"},children:n.jsx(Q,{createAccountButtonText:ve.createAccountButtonText,widgetBodyText:ve.widgetBodyText,handleSubmit:()=>{ae("/register")}})})]})})}),ve.widgetFooterText&&n.jsx(t,{sx:{minHeight:"48px",width:xe||Y?"100%":"50%"},html:ve.widgetFooterText})]})})})})})}));const X=()=>{const e=y((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),t=y((({company:e})=>e.customer.b2bId)),n=y((({b2bFeatures:e})=>e.masqueradeCompany.id)),o=f(),i=e&&"number"==typeof t;return{endMasquerade:l.useCallback((async()=>{i&&(await C(+n,t),o(B()))}),[t,i,n,o]),isMasquerade:i}},ee=e=>{if(e)switch(e){case"1":case"4":return"error";case"5":return"warning";default:return"success"}}}}}));
